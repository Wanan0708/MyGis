# 瓦片地图保存位置说明

## 保存目录

### 主目录
- **路径**: `E:\Project\CursorProject\CustomTitleBarApp\tilemap\`
- **说明**: 所有下载的瓦片地图都保存在项目根目录下的 `tilemap` 文件夹中

### 目录结构
```
E:\Project\CursorProject\CustomTitleBarApp\
├── tilemap\                    # 瓦片缓存主目录
│   ├── 1\                      # 缩放级别1
│   │   └── 1\
│   │       └── 0.png
│   ├── 2\                      # 缩放级别2
│   │   ├── 2\
│   │   │   └── 1.png
│   │   └── 3\
│   │       └── 1.png
│   ├── 3\                      # 缩放级别3
│   │   ├── 5\
│   │   │   ├── 2.png
│   │   │   └── 3.png
│   │   ├── 6\
│   │   │   ├── 2.png
│   │   │   └── 3.png
│   │   └── 7\
│   │       ├── 2.png
│   │       └── 3.png
│   ├── 4\                      # 缩放级别4
│   │   ├── 11\
│   │   │   ├── 5.png
│   │   │   ├── 6.png
│   │   │   └── 7.png
│   │   ├── 12\
│   │   │   ├── 5.png
│   │   │   ├── 6.png
│   │   │   └── 7.png
│   │   ├── 13\
│   │   │   ├── 5.png
│   │   │   ├── 6.png
│   │   │   └── 7.png
│   │   └── 14\
│   │       ├── 5.png
│   │       ├── 6.png
│   │       └── 7.png
│   ├── 5\                      # 缩放级别5
│   │   ├── 22\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   ├── 23\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   ├── 24\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   ├── 25\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   ├── 26\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   ├── 27\
│   │   │   ├── 10.png
│   │   │   ├── 11.png
│   │   │   ├── 12.png
│   │   │   ├── 13.png
│   │   │   └── 14.png
│   │   └── 28\
│   │       ├── 10.png
│   │       ├── 11.png
│   │       ├── 12.png
│   │       ├── 13.png
│   │       └── 14.png
│   └── 10\                     # 缩放级别10
│       ├── 841\
│       │   ├── 386.png
│       │   ├── 387.png
│       │   ├── 388.png
│       │   ├── 389.png
│       │   └── 390.png
│       ├── 842\
│       │   ├── 386.png
│       │   ├── 387.png
│       │   ├── 388.png
│       │   ├── 389.png
│       │   └── 390.png
│       ├── 843\
│       │   ├── 386.png
│       │   ├── 387.png
│       │   ├── 388.png
│       │   ├── 389.png
│       │   └── 390.png
│       ├── 844\
│       │   ├── 386.png
│       │   ├── 387.png
│       │   ├── 388.png
│       │   ├── 389.png
│       │   └── 390.png
│       └── 845\
│           ├── 386.png
│           ├── 387.png
│           ├── 388.png
│           ├── 389.png
│           └── 390.png
└── 其他项目文件...
```

## 文件命名规则

### 瓦片文件路径格式
```
tilemap/{缩放级别}/{X坐标}/{Y坐标}.png
```

### 示例
- `tilemap/1/1/0.png` - 缩放级别1，X坐标1，Y坐标0
- `tilemap/10/841/386.png` - 缩放级别10，X坐标841，Y坐标386

## 当前下载状态

### 已下载瓦片统计
| 缩放级别 | 瓦片数量 | 状态 |
|---------|---------|------|
| 1       | 1       | ✅ 完成 |
| 2       | 2       | ✅ 完成 |
| 3       | 6       | ✅ 完成 |
| 4       | 12      | ✅ 完成 |
| 5       | 34      | ✅ 完成 |
| 6       | 0       | ❌ 未下载 |
| 7       | 0       | ❌ 未下载 |
| 8       | 0       | ❌ 未下载 |
| 9       | 0       | ❌ 未下载 |
| 10      | 25      | 🔄 部分下载 |

### 总计
- **已下载**: 80个瓦片
- **目标**: 89,479个瓦片（1-10级）
- **完成度**: 约0.09%

## 技术实现

### 缓存目录设置
```cpp
// 在 TileMapManager 构造函数中
m_cacheDir = QDir::currentPath() + "/tilemap";
```

### 文件路径生成
```cpp
QString TileMapManager::getTilePath(int x, int y, int z)
{
    return QString("%1/%2/%3/%4.png").arg(m_cacheDir).arg(z).arg(x).arg(y);
}
```

### 目录自动创建
```cpp
// 在保存瓦片时自动创建目录
QDir dir(QFileInfo(tilePath).path());
if (!dir.exists()) {
    dir.mkpath(".");
}
```

## 优势

### ✅ **项目相对路径**
- 瓦片保存在项目目录下，便于管理和备份
- 不依赖系统临时目录，避免清理问题
- 便于版本控制和项目迁移

### ✅ **标准瓦片格式**
- 遵循标准的瓦片地图文件结构
- 兼容大多数地图库和工具
- 便于后续扩展和维护

### ✅ **自动目录管理**
- 系统自动创建必要的目录结构
- 无需手动创建文件夹
- 支持任意缩放级别的瓦片

## 注意事项

### 1. 存储空间
- 1-10级瓦片预计需要约1.8GB存储空间
- 建议确保有足够的磁盘空间

### 2. 文件权限
- 确保程序有写入权限
- 避免在只读目录中运行

### 3. 备份建议
- 可以备份整个 `tilemap` 目录
- 支持跨设备迁移瓦片数据

### 4. 清理建议
- 可以手动删除不需要的缩放级别
- 定期清理损坏的瓦片文件

## 访问方式

### 程序内访问
- 程序启动时自动检查 `tilemap` 目录
- 优先加载本地瓦片，减少网络请求
- 支持离线地图显示

### 手动访问
- 可以直接在文件管理器中查看
- 支持复制、移动、删除操作
- 便于调试和问题排查

现在你的瓦片地图都保存在 `E:\Project\CursorProject\CustomTitleBarApp\tilemap\` 目录中！

